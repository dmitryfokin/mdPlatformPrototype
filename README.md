# mdPlatformPrototype

Прототип платформы разработки прикладных программ для предприятий

Общие принципы спецификации платформы

1.  Клиент - серверная архитектура.Вся бизнес логика обрабатывается на сервере. На клиенте происходит только отображение данных

1.  Вся модель прикладной области полностью определена в метаданных приложения

1.  Данные модели прикладной области классифицируются (объединяются) по поведению в модели:

    *  Мастер данные [MasterData] - перечислимые, постоянно используемые, данные.Классификаторы, справочники. (Страны, Клиенты, Товары, Статьи расходов, Сотрудники, Единицы измерения, и т.д.)
    *  Транзационные данные [Document] - данны прикладной области описывающие операции, события, действия (Заказы покупателей, Оплаты, Начисление зароботной платы, Ввод в эксплуатацию основных средств, путевые листы)
    *  Информационные данные [InfoData] - уточняющие данные для мастер данных, которые не имеют Ссылки (Ref)(идентификатора), т.е. являются классической связью многие ко многим, например Товары контрагентов, могут содержать данные о товаре для каждого контрагента: идентификатор (артикул), наименование, которое использует контрагент
    * Периодические информационные данные [InfoDataPeriod] - то же, что Информационные данные, но ещё имеет аналитику по периоду, например Цены по видам номенклатуры, имеет три реквизита: Товар, Тип цены, Цена и Период действия цены, т.е. можно получить последнюю цену на текущий день
    *  Сальдовые данные [InfoBalance] - данные для ускорения расчетов числовых оборотов и остатков. Например транзакционный объект - Реализация (Продажа товара) может делать движения по нескольким Сальдовым таблицам: Продажи, Товары на складах, Расчеты с клиентом, Налоги, Себестоимость продаж и т.п.
    *  Данные двойной записи [InfoDoubleEntry] - сальдовая инфрмация в виде двойной записи. Для финансовой и бухгалтерской информации

1.  Основная работа с прикладными объектами происходит с помощью Ссылок [Ref]. Ссылка предназначена только для чтения информации, и не предназначена для изменения, или удаления данных. Ссылка содержит все реквизиты, определенные в метданных

1.  Ссылка может быть короткой [RefShot]. Короткая Ссылка предназначена для получения ссылочных данных в реквизитах, вместо идентификатора. При обращении к реквизитам Короткой Ссылки платформа получает обычную Ссылку со всеми реквизитами. Короткая Ссылка представляет собой структуру:
    *  Объект метаданных (MasterData.Goods) 
    *  Идентификатор (e3337061-dba1-42bd-829a-056c91d93e8a)
    *  Представление Ссылки (Сок апельсиновый, 1л)
    В дальнейшем для оптимизации объема данных, Объект метаданных и Идентификатор можно хранить в двоичном виде.

1.  Изменение данных происходит с помощью Объектов

    *  Создание объекта - происходит из объекта метаданных 
    ``` JavaScript 
    const newGood = MasterData.Goods.create();
    ```
    *  Получение объекта из Ссылки (Короткой Ссылки)
    ``` JavaScript 
    const refGood = MasterData.Goods.findByName('Сок апельсиновый, 1л');
    if (refGood.empty()) throw new Error('Товар не найден');
    const objGood = refGood.getObject();
    objGood.name = 'Сок апельсиновый, 970мл';
    objGood.volumeInMilliliters = 970;
    objGood.save();
    ```

1.  TODO... Бизнес логика происходит в обработчиках событий. Например для Мастер Данных определяются события:

    *  Перед созданием, можно установить определенный идентификатор, заполнить реквизиты данными по умолчанию
    *  Перед записью
    *  После записи
    *  Перед удалением

1.  TODO... Клиентская часть приложения - представляет собой описанную на DDL совокупность описания набора данных и описание метаданных формы - элементов: полей ввода, кнопок, таблиц и т.д. и связь элементов формы и элементов набора данных.
    *  на серверной части в сессии пользователя создается экземпляр формы с набором данных, и элементами формы
    *  на клиентской части создается отображение элементов формы, далее представление данных синхронизируется
    *  далее клиент обрабатывает события элементов формы (действий пользователя) и передает их на сервер, где события обрабатываются согласно бизнес логике прикладного приложения